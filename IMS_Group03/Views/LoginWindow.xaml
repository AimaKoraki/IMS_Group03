<!-- COMPLETE AND FINALIZED: LoginWindow.xaml -->
<Window x:Class="IMS_Group03.LoginWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:IMS_Group03"
        xmlns:converters="clr-namespace:IMS_Group03.Converters"
        mc:Ignorable="d"
        Title="Login - Inventory Management System" Height="500" Width="420"
        WindowStartupLocation="CenterScreen" ResizeMode="NoResize"
        WindowStyle="SingleBorderWindow" Background="{StaticResource PrimaryBackgroundBrush}"
        KeyDown="Window_KeyDown">

    <Window.Resources>
        <!-- Converters needed for binding UI state -->
        <converters:BooleanToVisibilityConverter x:Key="BoolToVis" />
        <converters:InverseBooleanConverter x:Key="InvertBool" />
        <converters:NullToVisibilityConverter x:Key="NullToVis" />
    </Window.Resources>

    <Grid>
        <Border Style="{StaticResource LoginPanelStyle}" VerticalAlignment="Center" HorizontalAlignment="Center" Width="380">
            <StackPanel>
                <TextBlock Text="Store Management" Style="{StaticResource LoginTitleStyle}"/>
                <TextBlock Text="Sign in to your account" Style="{StaticResource LoginSubtitleStyle}"/>

                <TextBlock Text="Username" Style="{StaticResource LabelStyleDark}"/>
                <!-- Bind the Text property to the Username property on the controller -->
                <TextBox x:Name="UsernameTextBox" Style="{StaticResource TextBoxDarkStyle}" Margin="0,0,0,15" TabIndex="0"
                         Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}"/>

                <TextBlock Text="Password" Style="{StaticResource LabelStyleDark}"/>
                <PasswordBox x:Name="PasswordInputBox" Style="{StaticResource PasswordBoxDarkStyle}" Margin="0,0,0,20" TabIndex="1"/>

                <!-- Error message is now bound to the controller's ErrorMessage property -->
                <TextBlock Foreground="{StaticResource DangerBrush}" TextWrapping="Wrap" MinHeight="20" Margin="0,0,0,10"
                           Text="{Binding ErrorMessage}"
                           Visibility="{Binding ErrorMessage, Converter={StaticResource NullToVis}}"/>

                <!-- Login button is disabled when the controller is busy -->
                <Button x:Name="LoginBtn" Content="Login" Style="{StaticResource PrimaryActionButtonStyle}" Click="LoginButton_Click" Margin="0,10,0,8" TabIndex="2"
                        IsEnabled="{Binding IsBusy, Converter={StaticResource InvertBool}}"/>

                <Button Content="Cancel" Style="{StaticResource SecondaryActionButtonStyle}" Click="CancelButton_Click" TabIndex="3"/>
            </StackPanel>
        </Border>

        <!-- Loading overlay, consistent with DashboardView -->

    </Grid>
</Window>